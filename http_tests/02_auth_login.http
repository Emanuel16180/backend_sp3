### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### ๐ FLUJO: LOGIN DE USUARIOS
### Archivo: 02_auth_login.http
### Endpoints: /api/auth/login/, /api/auth/logout/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

@baseUrl = http://bienestar.localhost:8000
@baseMindcare = http://mindcare.localhost:8000

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 1๏ธโฃ LOGIN COMO PACIENTE
### POST /api/auth/login/
### Guarda el token en @authToken
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# @name loginPaciente
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "juan.perez@example.com",
  "password": "demo123"
}

###
@authToken = {{loginPaciente.response.body.token}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 2๏ธโฃ LOGIN COMO PROFESIONAL (PSICรLOGO)
### POST /api/auth/login/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# @name loginProfesional
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "dra.martinez@bienestar.com",
  "password": "demo123"
}

###
@professionalToken = {{loginProfesional.response.body.token}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 3๏ธโฃ LOGIN COMO ADMINISTRADOR DE CLรNICA
### POST /api/auth/login/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# @name loginAdmin
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "admin@bienestar.com",
  "password": "admin123"
}

###
@adminToken = {{loginAdmin.response.body.token}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 4๏ธโฃ LOGIN EN CLรNICA MINDCARE (OTRO TENANT)
### POST /api/auth/login/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
# @name loginMindcare
POST {{baseMindcare}}/api/auth/login/
Content-Type: application/json

{
  "email": "carlos.ruiz@example.com",
  "password": "demo123"
}

###
@mindcareToken = {{loginMindcare.response.body.token}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 5๏ธโฃ LOGIN DE ADMIN GLOBAL (TENANT PรBLICO)
### POST /api/auth/login/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
POST http://127.0.0.1:8000/api/auth/login/
Content-Type: application/json

{
  "email": "admin@psicoadmin.xyz",
  "password": "admin123"
}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 6๏ธโฃ VER PERFIL DEL USUARIO AUTENTICADO
### GET /api/auth/profile/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GET {{baseUrl}}/api/auth/profile/
Authorization: Token {{authToken}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### 7๏ธโฃ LOGOUT (CERRAR SESIรN)
### POST /api/auth/logout/
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
POST {{baseUrl}}/api/auth/logout/
Authorization: Token {{authToken}}

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### โ CASOS DE ERROR COMUNES
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

### ERROR: Credenciales incorrectas
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "juan.perez@example.com",
  "password": "password_incorrecta"
}

###

### ERROR: Email no existe
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "noexiste@example.com",
  "password": "demo123"
}

###

### ERROR: Falta campo requerido
POST {{baseUrl}}/api/auth/login/
Content-Type: application/json

{
  "email": "juan.perez@example.com"
}

###

### ERROR: Acceso sin token
GET {{baseUrl}}/api/auth/profile/

###

### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
### ๐ RESPUESTAS ESPERADAS
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
###
### โ LOGIN EXITOSO (200 OK):
### {
###   "message": "Sesiรณn iniciada exitosamente",
###   "user": {
###     "id": 5,
###     "email": "juan.perez@example.com",
###     "first_name": "Juan",
###     "last_name": "Perez",
###     "user_type": "patient",
###     "has_completed_triage": false
###   },
###   "token": "9b8c7d6e5f4a3b2c1d0..."
### }
###
### โ LOGOUT EXITOSO (200 OK):
### {
###   "message": "Sesiรณn cerrada exitosamente"
### }
###
### โ ERROR CREDENCIALES (400 Bad Request):
### {
###   "non_field_errors": [
###     "Credenciales invรกlidas o usuario inactivo."
###   ]
### }
###
### โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
